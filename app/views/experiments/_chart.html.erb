

<div id="experiment_chart" style="height: 250px; margin: 30px;"></div>

<script>
var graph_data = [
  <% @chart_data.each do |time, values| %>
    { time: '<%== j time.to_formatted_s(:db) %>',
      <% values.each do |device_id, ppm| %>
        id_num_<%= device_id.to_s %>: <%= ppm %>,
      <% end %>
    },
  <% end %>
  ];

var graph = new Morris.Line({
  // ID of the element in which to draw the chart.
  element: 'experiment_chart',
  // Chart data records -- each entry in this array corresponds to a point on
  // the chart.
  data: graph_data,
  // The name of the data record attribute that contains x-values.
  xkey: 'time',
  //xLabels: "second",
  //parse_time: false,
  // A list of names of data record attributes that contain y-values.
  ykeys: <%== @chart_ykeys %>,

  goals: [10000],
  // Labels for the ykeys -- will be displayed when you hover over the
  // chart.
  labels: <%== @chart_labels.keys.to_json %>,

  ymin: 0,
  pointStrokeColors: ['#bbbbff'],
  pointSize: 3,
  hideHover: 'auto',

});

function update() {
  graph.setData(graph_data);
}
setInterval(update, 10000);

</script>